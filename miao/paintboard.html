<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>
    .point {
      border-radius: 9999px;
      position: absolute;
    }

    svg {
      border: 1px solid cyan;
    }
  </style>
</head>

<body>
  <svg width="500" height="500"></svg>
  <br>
  <input type="color" id="colorInput">
  <input type="range" min='2' max='16' value='8 step ='2' id="rangeInput">
  <span id="line-width-value">8</span>
  <script>
    
    let draw = false;
    let svg = document.querySelector('svg');
    let lastPos = null;
    document.addEventListener('mousedown', function (e) {
      // draw points
      document.addEventListener('click', function (e) {
        console.log(e);
        let point = document.createElement('div');
        point.className = 'point';
        point.style.left = e.pageX + rangeInput.value / 2 + 'px';
        point.style.top = e.pageY + rangeInput.value / 2 + 'px';
  
        point.style.width = rangeInput.value + 'px';
        point.style.height = rangeInput.value + 'px';
        point.style.backgroundColor = colorInput.value;
        document.body.append(point);
      })
      
      // drawLine
      function drawLine(e) {
        let pos = mousePos(svg);
        let line = document.createElementNS("http://www.w3.org/2000/svg", 'line');

        if (lastPos == null) {
          line.setAttribute('x1', pos.x);
          line.setAttribute('y1', pos.y);
        } else {
          line.setAttribute('x1', lastPos.x);
          line.setAttribute('y1', lastPos.y);
        }

        line.setAttribute('x2', pos.x);
        line.setAttribute('y2', pos.y);
        line.setAttribute('stroke', colorInput.value);
        line.setAttribute('stroke-width', rangeInput.value);
        line.setAttribute('stroke-linecap', 'round');

        lastPos = pos;
        svg.append(line);
      }

      document.addEventListener('mousemove', drawLine);
      document.addEventListener('mouseup', function once() {
        lastPos = null;
        document.removeEventListener('mouseup', once);
        document.removeEventListener('mousemove', drawLine);
      })
    })

    function mousePos(node) {
      let ele = node.getBoundingClientRect();

      return {
        x: window.event.clientX - ele.x,
        y: window.event.clientY - ele.y,
      }
    }

    let widthSpan = document.querySelector('#line-width-value');
    rangeInput.addEventListener('input', e => {
        widthSpan.textContent = rangeInput.value;
      })
  </script>
</body>

</html>
